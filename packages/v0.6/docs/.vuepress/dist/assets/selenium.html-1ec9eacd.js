import{_ as e,E as t,Z as i,$ as p,a0 as n,a3 as s,a1 as o,a4 as c}from"./framework-64cb0dab.js";const l={},r=n("h1",{id:"selenium-spider-integration",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#selenium-spider-integration","aria-hidden":"true"},"#"),s(" Selenium Spider Integration")],-1),u=n("h2",{id:"introduction-to-selenium",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#introduction-to-selenium","aria-hidden":"true"},"#"),s(" Introduction to Selenium")],-1),d={href:"https://selenium-python.readthedocs.io/index.html",target:"_blank",rel:"noopener noreferrer"},k=c(`<h2 id="integrating-selenium-spider-in-crawlab" tabindex="-1"><a class="header-anchor" href="#integrating-selenium-spider-in-crawlab" aria-hidden="true">#</a> Integrating Selenium Spider in Crawlab</h2><p>Below, we will explain how to integrate a Selenium spider into Crawlab and display the scraping results in the Crawlab frontend interface. We will demonstrate the process using the example of scraping 36kr (36æ°ª) website.</p><h3 id="creating-the-spider" tabindex="-1"><a class="header-anchor" href="#creating-the-spider" aria-hidden="true">#</a> Creating the Spider</h3><p>In the Crawlab spider list, create a spider named &quot;36kr&quot; with the execution command <code>python main.py</code>.</p><h3 id="editing-the-spider-file" tabindex="-1"><a class="header-anchor" href="#editing-the-spider-file" aria-hidden="true">#</a> Editing the Spider File</h3><p>Create and open the <code>main.py</code> file and enter the following content:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> crawlab <span class="token keyword">import</span> save_item

<span class="token comment"># create web driver with chrome</span>
chrome_options <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--headless&#39;</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--no-sandbox&#39;</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--disable-dev-shm-usage&#39;</span><span class="token punctuation">)</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span>

<span class="token comment"># navigate to the news list page</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://36kr.com/information/web_news/&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># get article items</span>
items <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;.information-flow-list &gt; .information-flow-item&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># iterate through items</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
    <span class="token comment"># extract fields</span>
    el_title <span class="token operator">=</span> item<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;.article-item-title&#39;</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> el_title<span class="token punctuation">.</span>text
    url <span class="token operator">=</span> el_title<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">&#39;href&#39;</span><span class="token punctuation">)</span>
    topic <span class="token operator">=</span> item<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;.kr-flow-bar-motif &gt; a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
    description <span class="token operator">=</span> item<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;.article-item-description&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        pic_url <span class="token operator">=</span> item<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">&#39;.article-item-pic &gt; img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        pic_url <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token comment"># save to Crawlab</span>
    save_item<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&#39;title&#39;</span><span class="token punctuation">:</span> title<span class="token punctuation">,</span>
        <span class="token string">&#39;url&#39;</span><span class="token punctuation">:</span> url<span class="token punctuation">,</span>
        <span class="token string">&#39;topic&#39;</span><span class="token punctuation">:</span> topic<span class="token punctuation">,</span>
        <span class="token string">&#39;description&#39;</span><span class="token punctuation">:</span> description<span class="token punctuation">,</span>
        <span class="token string">&#39;pic_url&#39;</span><span class="token punctuation">:</span> pic_url<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this code, we define the <code>chrome_options</code> for the Chrome browser and include the following important parameters:</p><div class="hint-container warning"><p class="hint-container-title">Note</p><p>These parameters are crucial; otherwise, the script may not run correctly in Crawlab!</p></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--headless&#39;</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--no-sandbox&#39;</span><span class="token punctuation">)</span>
chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--disable-dev-shm-usage&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, we use the <code>save_item</code> method from the Crawlab SDK to save the scraping results obtained by the web scraper.</p><h3 id="running-the-spider" tabindex="-1"><a class="header-anchor" href="#running-the-spider" aria-hidden="true">#</a> Running the Spider</h3><p>Run the &quot;36kr&quot; spider in Crawlab to obtain the scraping results.</p>`,13);function m(h,v){const a=t("ExternalLinkIcon");return i(),p("div",null,[r,u,n("p",null,[n("a",d,[s("Selenium"),o(a)]),s(" is a tool primarily used for web application testing, but it can also be used to write web scrapers. Unlike traditional HTTP request libraries (such as Requests), Selenium allows you to simulate browser behavior and automate the browser to gather data. This is particularly useful for scraping dynamic web pages that require JavaScript rendering.")]),k])}const g=e(l,[["render",m],["__file","selenium.html.vue"]]);export{g as default};
