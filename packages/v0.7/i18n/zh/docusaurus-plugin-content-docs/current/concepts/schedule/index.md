---
sidebar_position: 4
title: 定时任务
---

# 定时任务

大多数情况下，我们可能需要定期运行爬虫的[任务](../task/index.md)。现在你需要一个定时任务。

Crawlab 中的“定时任务”概念类似于 Linux 中的 [crontab](https://www.tutorialspoint.com/unix_commands/crontab.htm)。它是一个周期性运行爬虫任务的长期任务。

:::tip
如果你想配置一个每天/每周/每月自动运行爬取任务的网络爬虫，你应该设置一个 *定时任务*。定时任务是自动化操作的最佳方式，特别是对于爬取增量内容的爬虫。
:::

## 创建定时任务

1. 导航到 `定时任务` 页面。
2. 点击左上角的 `新建定时任务` 按钮。
3. 输入基本信息，包括 `名称`、[Cron 表达式](https://www.tutorialspoint.com/unix_commands/crontab.htm) 和 `爬虫`。
4. 点击 `确认`。

创建的定时任务默认是启用的。一旦你创建了一个已启用的定时任务，它将根据你设置的 Cron 表达式按时触发一个[任务](../task/index.md)。

:::tip
你可以通过创建一个新的定时任务并将 `Cron 表达式` 设置为 `* * * * *`（即“每分钟”），来调试 Crawlab 中的定时任务模块是否正常工作，这样你可以在下一分钟开始时检查任务是否被触发。
:::

## 启用/禁用定时任务

你可以在 `定时任务` 页面和定时任务详情页面中通过切换 `启用` 属性的开关按钮来启用或禁用定时任务。

## Cron 表达式

*Cron 表达式* 是一种简单且标准的格式，用于描述任务的周期性。它与 Linux `crontab` 中的格式相同。

```
*    *    *   *    *  Command_to_execute
|    |    |    |   |       
|    |    |    |    Day of the Week ( 0 - 6 ) ( Sunday = 0 )
|    |    |    |
|    |    |    Month ( 1 - 12 )
|    |    |
|    |    Day of Month ( 1 - 31 )
|    |
|    Hour ( 0 - 23 )
|
Min ( 0 - 59 )
```

- 星号 (*) 操作符指定字段的所有可能值。例如，每小时或每天。
- 逗号 (,) 操作符指定值列表，例如："1,3,4,7,8"。
- 连字符 (-) 操作符指定值范围，例如："1-6"，相当于 "1,2,3,4,5,6"。
- 斜杠 (/) 操作符可用于跳过给定数量的值。例如，在小时字段中使用 "\*/3" 相当于 "0,3,6,9,12,15,18,21"；"\*" 表示“每小时”，但 "/3" 表示只使用由 "*" 给出的第一个、第四个、第七个等值。

:::warning
Crawlab 中的 *Cron 表达式* 使用与 Linux `crontab` 中相同的格式。也就是说，最小单位是 **分钟**。这不同于一些 crontab 风格的调度框架，它们的最小单位是秒。
:::

:::tip
如果你不确定你的 Cron 表达式是否正确，可以访问 [https://crontab.guru](https://crontab.guru/) 来验证其正确性。
:::